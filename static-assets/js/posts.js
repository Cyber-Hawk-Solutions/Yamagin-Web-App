var JekyllPWA=JekyllPWA||{},mentions=[];JekyllPWA.Posts={init:function(){this.initDisplayMentions(),this.initCreateMentionsStore(),this.initStoreMentions()},initDisplayMentions:function(){const e=document.getElementById("page-path").value;fetch("https://webmention.io/api/mentions?target="+e).then(e=>e.json()).then(e=>{0==e.links.length?console.log("no mentions yet"):(document.querySelector(".post-webmentions").removeAttribute("hidden"),e.links.forEach(function(e){var t=document.getElementById("mention-tmpl").content.cloneNode(!0);t.querySelector(".mention-reply-content").innerHTML=e.data.content,t.querySelector(".mention-reply-author").innerText=e.data.author.name,t.querySelector(".mention-reply-link").setAttribute("href",e.source),t.querySelector(".mention-reply-link").innerText=e.data.author.url,document.getElementById("webmentions-container").appendChild(t),mentions.push({id:e.id,source:e.source,target:e.target,content:e.data.content,author:e.data.author.name,url:e.data.author.url})})),console.log(e)})},initCreateMentionsStore:function(){const e=document.getElementById("page-id").value;var t=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB).open("Mentions",1);t.onupgradeneeded=function(){t.result.createObjectStore(e,{keyPath:"id"}),store.createIndex(e+"-index","id")}},initStoreMentions:function(){const e=document.getElementById("page-id").value;mentions.forEach(function(t){window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB;var n=window.indexedDB.open("Mentions",1);n.onsuccess=function(o){db=n.result;var i=db.transaction([e],"readwrite"),r=i.objectStore(e);r=(i=db.transaction([e],"readwrite")).objectStore(e),objectStoreRequest=r.put({id:t.id,source:t.source,target:t.target,content:t.content,author:t.author,url:t.author}),objectStoreRequest.oncomplete=function(e){console.log("asd")}}})}},JekyllPWA.Posts.init();